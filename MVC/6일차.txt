
 6일차 - 43 ~ 45강.



 # POST입력 한글 입력이 깨지는 문제.

설명.
서블릿과 웹 브라우저 사이에 filter 클래스를 설정하여 입력데이터를 어떠한 처리를 할 수 있게한다.

사용.
<filter>
	<filter-name>필터이름</filter-name>
	<filter-class>패키지이름.클래스이름</filter-class>
	<init-param>
		<param-name>encoding</param-name>
		<param-value>UTF-8</param-value>
	</init-param>
	<init-param>
		<param-name>forceEncoding</param-name>
		<param-value>true</param-value>		
	</init-param>
</filter>
<filter-mapping>
	<filter-name>필터이름</filter-name>
	<url-pattern>/ * </url-pattern>
</filter-mapping>



 # POST 입력. ( 파일 업로드 )

설명.
파일을 업로드하는 방식과 일반 문자 등을 받는 방식이 다른 방식이다.
CommonsMultipartResolver class를 통해 파일을 받을 수 있는 방식을 설정해줘야된다.

dispatcher-context.xml 설정.
<bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
	<property name="maxUploadSize" value="314572800" />
</bea>

html파일 설정.
<form ~~~ enctype="multipart/form-data" >

pom.xml 설정.
Dependencies -> Add -> commons-fileupload 검색 -> commons-fileupload ( commons-fileupload )



 # POST 입력 물리경로 얻기와 파일 저장하기.

설명.
ServletContext를 통해 절대 경로를 얻어서 그 장소에 파일을 저장하고 사용.

ServletContext.
IoC에 미리 담아놓고 있기 때문에 @Autowired를 통해 사용할 수 있다.

ServletContext 얻는 방법.
@Autowired
private ServletContext ctx ; ( 여러개의 컨트롤러에서 사용할 경우 전역변수로 사용 )
( HttpServletRequest request ) ( 해당 컨트롤러에서 사용할 경우 - request.getServletContext ) 

전체 사용 방법.
@Autowired
private ServletContext ctx ; 
public void 메소드이름( MultipartFile file ) { 
	String fileName = file.getOriginalFilename( ) ;
	String webPath = "/프로젝트에서의 url" ;
	String realPath = ctx.getRealPath( webPath ) ;
	File savePath = new File( realPath ) ;

	if( !savePath.exists( ) ) { 
		savePath.mkdirs( ) ;
	}

	realPath += File.separator + fileName ;
	File saveFile = new File( realpath ) ;
	saveFile.transferTo( saveFile ) ;
}

추가설명.
File클래스에 exists( )를 통해 경로가 존재하는지 확인하고, mkdirs( )를 통해 모든 경로의 폴더를 생성.
File클래스에 realPath를 넣어서 생성하고, transferTo( 입력파일 )을 통해 실제경로에 입력파일을 생성.

정리.
1. 실제 경로를 찾아준다.
2. 실제 경로의 폴더가 존재하는지 확인 후 없으면 생성해준다.
3. 실제 경로의 File클래스 생성 후 입력받은 파일을 전송해서 실제 경로에 생성한다.



